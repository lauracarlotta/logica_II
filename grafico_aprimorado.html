<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gr√°fico de Browsers (APRIMORADO)</title>
</head>

<body>
    
    <canvas width="800" height="600"></canvas>

    <script>

    let tela = document.querySelector('canvas');
    let pincel = tela.getContext('2d');

    pincel.fillStyle = 'lightgray';
    pincel.fillRect(50, 50, 600, 400);
    
    function desenhaRetangulo(eixoX, eixoY, largura, altura, cor) {
        
        let tela = document.querySelector('canvas');
        let pincel = tela.getContext('2d');

        pincel.fillStyle = cor;
        pincel.fillRect(eixoX, eixoY, largura, altura);
        pincel.strokeStyle ='black';
        pincel.strokeRect(eixoX, eixoY, largura, altura);
    }

    function desenhaTexto(eixoX, eixoY, texto) {
        
        let tela = document.querySelector('canvas');
        let pincel = tela.getContext('2d');
        pincel.font = '15px Georgia';
        pincel.fillStyle = 'black';
        pincel.fillText(texto, eixoX, eixoY);    
    }

    function desenhaBarra(eixoX, eixoY, serie, cores, texto) {

        desenhaTexto(eixoX + 30, eixoY - 10, texto);

        let somaAltura = 0;

        for (let indice = 0; indice < serie.length; indice++){

            let altura = serie[indice];

            desenhaRetangulo(eixoX, eixoY + somaAltura, 100, altura, cores[indice]);
            somaAltura = somaAltura + altura;
        }
        
    } 

    function desenhaLegenda(eixoX, eixoY, texto) { // eu acrescentei

        desenhaTexto(eixoX + 10, eixoY + 20, texto)

        let alturaRetanguloLegenda = 0;
        for (let indice = 0; indice < retanguloLegenda.length; indice++) {
            let altura = retanguloLegenda[indice];
            desenhaRetangulo(eixoX + 20, eixoY + 40 + alturaRetanguloLegenda, 40, altura, cores[indice]);
            alturaRetanguloLegenda+=altura;
        }

        desenhaTexto(eixoX + 70, eixoY + 60, 'Google');
        desenhaTexto(eixoX + 70, eixoY + 105, 'Firefox');
        desenhaTexto(eixoX + 70, eixoY + 150, 'Safari');
        desenhaTexto(eixoX + 70, eixoY + 190, 'Outros');
    }

    let retanguloLegenda = [40, 40, 40, 40]; // eu acrescentei

    let serie2015 = [50, 25, 20, 5];
    let serie2016 = [65, 20, 13, 2];
    let cores = ['blue', 'green', 'yellow', 'red'];

    desenhaLegenda(50, 50, 'LEGENDA:'); // eu acrescentei

    desenhaBarra(200, 350, serie2015, cores, '2015');

    desenhaBarra(400, 350, serie2016, cores, '2016');

    desenhaTexto(10, 480, 'Estudo realizado entre 2015 e 2016 sobre os browsers Chrome, Firefox, Safari e outros.'); // eu acrescentei


    </script>

</body>

</html>
